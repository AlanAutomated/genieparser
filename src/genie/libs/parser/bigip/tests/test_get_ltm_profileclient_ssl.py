# Python
import unittest
from unittest.mock import Mock

# ATS
from ats.topology import Device
from ats.topology import loader

# Metaparser
from genie.metaparser.util.exceptions import SchemaEmptyParserError

# BigIP get_ltm_profileclient_ssl
from genie.libs.parser.bigip.get_ltm_profileclient_ssl import (
    LtmProfileClientssl,
)

# ==================================
# Unit test for parsing BigIP URL '/mgmt/tm/ltm/profile/client-ssl'
# ==================================


class FakeResponse(object):
    def json(self):
        return {
            "kind": "tm:ltm:profile:client-ssl:client-sslcollectionstate",
            "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl?ver=14.1.2.1",
            "items": [
                {
                    "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                    "name": "clientssl",
                    "partition": "Common",
                    "fullPath": "/Common/clientssl",
                    "generation": 1,
                    "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1",
                    "alertTimeout": "indefinite",
                    "allowDynamicRecordSizing": "disabled",
                    "allowExpiredCrl": "disabled",
                    "allowNonSsl": "disabled",
                    "appService": "none",
                    "authenticate": "once",
                    "authenticateDepth": 9,
                    "bypassOnClientCertFail": "disabled",
                    "bypassOnHandshakeAlert": "disabled",
                    "c3dDropUnknownOcspStatus": "drop",
                    "c3dOcsp": "none",
                    "caFile": "none",
                    "cacheSize": 262144,
                    "cacheTimeout": 3600,
                    "cert": "/Common/default.crt",
                    "certReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                    },
                    "certExtensionIncludes": [
                        "basic-constraints",
                        "subject-alternative-name",
                    ],
                    "certLifespan": 30,
                    "certLookupByIpaddrPort": "disabled",
                    "chain": "none",
                    "cipherGroup": "none",
                    "ciphers": "DEFAULT",
                    "clientCertCa": "none",
                    "crlFile": "none",
                    "defaultsFrom": "none",
                    "description": "none",
                    "destinationIpBlacklist": "none",
                    "destinationIpWhitelist": "none",
                    "forwardProxyBypassDefaultAction": "intercept",
                    "genericAlert": "enabled",
                    "handshakeTimeout": "10",
                    "hostnameBlacklist": "none",
                    "hostnameWhitelist": "none",
                    "inheritCaCertkeychain": "false",
                    "inheritCertkeychain": "false",
                    "key": "/Common/default.key",
                    "keyReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                    },
                    "maxActiveHandshakes": "indefinite",
                    "maxAggregateRenegotiationPerMinute": "indefinite",
                    "maxRenegotiationsPerMinute": 5,
                    "maximumRecordSize": 16384,
                    "modSslMethods": "disabled",
                    "mode": "enabled",
                    "notifyCertStatusToVirtualServer": "disabled",
                    "ocspStapling": "disabled",
                    "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                    "peerCertMode": "ignore",
                    "peerNoRenegotiateTimeout": "10",
                    "proxyCaCert": "none",
                    "proxyCaKey": "none",
                    "proxySsl": "disabled",
                    "proxySslPassthrough": "disabled",
                    "renegotiateMaxRecordDelay": "indefinite",
                    "renegotiatePeriod": "indefinite",
                    "renegotiateSize": "indefinite",
                    "renegotiation": "enabled",
                    "retainCertificate": "true",
                    "secureRenegotiation": "require",
                    "serverName": "none",
                    "sessionMirroring": "disabled",
                    "sessionTicket": "disabled",
                    "sessionTicketTimeout": 0,
                    "sniDefault": "false",
                    "sniRequire": "false",
                    "sourceIpBlacklist": "none",
                    "sourceIpWhitelist": "none",
                    "sslC3d": "disabled",
                    "sslForwardProxy": "disabled",
                    "sslForwardProxyBypass": "disabled",
                    "sslForwardProxyVerifiedHandshake": "disabled",
                    "sslSignHash": "any",
                    "strictResume": "disabled",
                    "uncleanShutdown": "enabled",
                    "certKeyChain": [
                        {
                            "name": "default",
                            "appService": "none",
                            "cert": "/Common/default.crt",
                            "certReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                            },
                            "chain": "none",
                            "key": "/Common/default.key",
                            "keyReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                            },
                            "usage": "SERVER",
                        }
                    ],
                },
                {
                    "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                    "name": "clientssl-insecure-compatible",
                    "partition": "Common",
                    "fullPath": "/Common/clientssl-insecure-compatible",
                    "generation": 1,
                    "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl-insecure-compatible?ver=14.1.2.1",
                    "alertTimeout": "indefinite",
                    "allowDynamicRecordSizing": "disabled",
                    "allowExpiredCrl": "disabled",
                    "allowNonSsl": "disabled",
                    "appService": "none",
                    "authenticate": "once",
                    "authenticateDepth": 9,
                    "bypassOnClientCertFail": "disabled",
                    "bypassOnHandshakeAlert": "disabled",
                    "c3dDropUnknownOcspStatus": "drop",
                    "c3dOcsp": "none",
                    "caFile": "none",
                    "cacheSize": 262144,
                    "cacheTimeout": 3600,
                    "cert": "/Common/default.crt",
                    "certReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                    },
                    "certExtensionIncludes": [
                        "basic-constraints",
                        "subject-alternative-name",
                    ],
                    "certLifespan": 30,
                    "certLookupByIpaddrPort": "disabled",
                    "chain": "none",
                    "cipherGroup": "none",
                    "ciphers": "ALL:!DH:!ADH:!EDH:@SPEED",
                    "clientCertCa": "none",
                    "crlFile": "none",
                    "defaultsFrom": "/Common/clientssl",
                    "defaultsFromReference": {
                        "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                    },
                    "description": "none",
                    "destinationIpBlacklist": "none",
                    "destinationIpWhitelist": "none",
                    "forwardProxyBypassDefaultAction": "intercept",
                    "genericAlert": "enabled",
                    "handshakeTimeout": "10",
                    "hostnameBlacklist": "none",
                    "hostnameWhitelist": "none",
                    "inheritCaCertkeychain": "false",
                    "inheritCertkeychain": "true",
                    "key": "/Common/default.key",
                    "keyReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                    },
                    "maxActiveHandshakes": "indefinite",
                    "maxAggregateRenegotiationPerMinute": "indefinite",
                    "maxRenegotiationsPerMinute": 5,
                    "maximumRecordSize": 16384,
                    "modSslMethods": "disabled",
                    "mode": "enabled",
                    "notifyCertStatusToVirtualServer": "disabled",
                    "ocspStapling": "disabled",
                    "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                    "peerCertMode": "ignore",
                    "peerNoRenegotiateTimeout": "10",
                    "proxyCaCert": "none",
                    "proxyCaKey": "none",
                    "proxySsl": "disabled",
                    "proxySslPassthrough": "disabled",
                    "renegotiateMaxRecordDelay": "indefinite",
                    "renegotiatePeriod": "indefinite",
                    "renegotiateSize": "indefinite",
                    "renegotiation": "enabled",
                    "retainCertificate": "true",
                    "secureRenegotiation": "request",
                    "serverName": "none",
                    "sessionMirroring": "disabled",
                    "sessionTicket": "disabled",
                    "sessionTicketTimeout": 0,
                    "sniDefault": "false",
                    "sniRequire": "false",
                    "sourceIpBlacklist": "none",
                    "sourceIpWhitelist": "none",
                    "sslC3d": "disabled",
                    "sslForwardProxy": "disabled",
                    "sslForwardProxyBypass": "disabled",
                    "sslForwardProxyVerifiedHandshake": "disabled",
                    "sslSignHash": "any",
                    "strictResume": "disabled",
                    "uncleanShutdown": "enabled",
                    "certKeyChain": [
                        {
                            "name": "default",
                            "appService": "none",
                            "cert": "/Common/default.crt",
                            "certReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                            },
                            "chain": "none",
                            "key": "/Common/default.key",
                            "keyReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                            },
                            "usage": "SERVER",
                        }
                    ],
                },
                {
                    "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                    "name": "clientssl-secure",
                    "partition": "Common",
                    "fullPath": "/Common/clientssl-secure",
                    "generation": 1,
                    "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl-secure?ver=14.1.2.1",
                    "alertTimeout": "indefinite",
                    "allowDynamicRecordSizing": "disabled",
                    "allowExpiredCrl": "disabled",
                    "allowNonSsl": "disabled",
                    "appService": "none",
                    "authenticate": "once",
                    "authenticateDepth": 9,
                    "bypassOnClientCertFail": "disabled",
                    "bypassOnHandshakeAlert": "disabled",
                    "c3dDropUnknownOcspStatus": "drop",
                    "c3dOcsp": "none",
                    "caFile": "none",
                    "cacheSize": 262144,
                    "cacheTimeout": 3600,
                    "cert": "/Common/default.crt",
                    "certReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                    },
                    "certExtensionIncludes": [
                        "basic-constraints",
                        "subject-alternative-name",
                    ],
                    "certLifespan": 30,
                    "certLookupByIpaddrPort": "disabled",
                    "chain": "none",
                    "cipherGroup": "none",
                    "ciphers": "ecdhe:rsa:!sslv3:!rc4:!exp:!des",
                    "clientCertCa": "none",
                    "crlFile": "none",
                    "defaultsFrom": "/Common/clientssl",
                    "defaultsFromReference": {
                        "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                    },
                    "description": "none",
                    "destinationIpBlacklist": "none",
                    "destinationIpWhitelist": "none",
                    "forwardProxyBypassDefaultAction": "intercept",
                    "genericAlert": "enabled",
                    "handshakeTimeout": "10",
                    "hostnameBlacklist": "none",
                    "hostnameWhitelist": "none",
                    "inheritCaCertkeychain": "false",
                    "inheritCertkeychain": "true",
                    "key": "/Common/default.key",
                    "keyReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                    },
                    "maxActiveHandshakes": "indefinite",
                    "maxAggregateRenegotiationPerMinute": "indefinite",
                    "maxRenegotiationsPerMinute": 5,
                    "maximumRecordSize": 16384,
                    "modSslMethods": "disabled",
                    "mode": "enabled",
                    "notifyCertStatusToVirtualServer": "disabled",
                    "ocspStapling": "disabled",
                    "tmOptions": "{ no-ssl }",
                    "peerCertMode": "ignore",
                    "peerNoRenegotiateTimeout": "10",
                    "proxyCaCert": "none",
                    "proxyCaKey": "none",
                    "proxySsl": "disabled",
                    "proxySslPassthrough": "disabled",
                    "renegotiateMaxRecordDelay": "indefinite",
                    "renegotiatePeriod": "indefinite",
                    "renegotiateSize": "indefinite",
                    "renegotiation": "disabled",
                    "retainCertificate": "true",
                    "secureRenegotiation": "require",
                    "serverName": "none",
                    "sessionMirroring": "disabled",
                    "sessionTicket": "disabled",
                    "sessionTicketTimeout": 0,
                    "sniDefault": "false",
                    "sniRequire": "false",
                    "sourceIpBlacklist": "none",
                    "sourceIpWhitelist": "none",
                    "sslC3d": "disabled",
                    "sslForwardProxy": "disabled",
                    "sslForwardProxyBypass": "disabled",
                    "sslForwardProxyVerifiedHandshake": "disabled",
                    "sslSignHash": "any",
                    "strictResume": "disabled",
                    "uncleanShutdown": "enabled",
                    "certKeyChain": [
                        {
                            "name": "default",
                            "appService": "none",
                            "cert": "/Common/default.crt",
                            "certReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                            },
                            "chain": "none",
                            "key": "/Common/default.key",
                            "keyReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                            },
                            "usage": "SERVER",
                        }
                    ],
                },
                {
                    "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                    "name": "crypto-server-default-clientssl",
                    "partition": "Common",
                    "fullPath": "/Common/crypto-server-default-clientssl",
                    "generation": 1,
                    "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~crypto-server-default-clientssl?ver=14.1.2.1",
                    "alertTimeout": "indefinite",
                    "allowDynamicRecordSizing": "disabled",
                    "allowExpiredCrl": "disabled",
                    "allowNonSsl": "disabled",
                    "appService": "none",
                    "authenticate": "once",
                    "authenticateDepth": 9,
                    "bypassOnClientCertFail": "disabled",
                    "bypassOnHandshakeAlert": "disabled",
                    "c3dDropUnknownOcspStatus": "drop",
                    "c3dOcsp": "none",
                    "caFile": "none",
                    "cacheSize": 0,
                    "cacheTimeout": 3600,
                    "cert": "/Common/default.crt",
                    "certReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                    },
                    "certExtensionIncludes": [
                        "basic-constraints",
                        "subject-alternative-name",
                    ],
                    "certLifespan": 30,
                    "certLookupByIpaddrPort": "disabled",
                    "chain": "none",
                    "cipherGroup": "none",
                    "ciphers": "DHE-RSA-AES256-GCM-SHA384",
                    "clientCertCa": "none",
                    "crlFile": "none",
                    "defaultsFrom": "/Common/clientssl",
                    "defaultsFromReference": {
                        "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                    },
                    "description": "none",
                    "destinationIpBlacklist": "none",
                    "destinationIpWhitelist": "none",
                    "forwardProxyBypassDefaultAction": "intercept",
                    "genericAlert": "enabled",
                    "handshakeTimeout": "10",
                    "hostnameBlacklist": "none",
                    "hostnameWhitelist": "none",
                    "inheritCaCertkeychain": "false",
                    "inheritCertkeychain": "true",
                    "key": "/Common/default.key",
                    "keyReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                    },
                    "maxActiveHandshakes": "indefinite",
                    "maxAggregateRenegotiationPerMinute": "indefinite",
                    "maxRenegotiationsPerMinute": 5,
                    "maximumRecordSize": 16384,
                    "modSslMethods": "disabled",
                    "mode": "enabled",
                    "notifyCertStatusToVirtualServer": "disabled",
                    "ocspStapling": "disabled",
                    "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                    "peerCertMode": "ignore",
                    "peerNoRenegotiateTimeout": "10",
                    "proxyCaCert": "none",
                    "proxyCaKey": "none",
                    "proxySsl": "disabled",
                    "proxySslPassthrough": "disabled",
                    "renegotiateMaxRecordDelay": "indefinite",
                    "renegotiatePeriod": "21600",
                    "renegotiateSize": "indefinite",
                    "renegotiation": "enabled",
                    "retainCertificate": "true",
                    "secureRenegotiation": "require",
                    "serverName": "none",
                    "sessionMirroring": "disabled",
                    "sessionTicket": "disabled",
                    "sessionTicketTimeout": 0,
                    "sniDefault": "false",
                    "sniRequire": "false",
                    "sourceIpBlacklist": "none",
                    "sourceIpWhitelist": "none",
                    "sslC3d": "disabled",
                    "sslForwardProxy": "disabled",
                    "sslForwardProxyBypass": "disabled",
                    "sslForwardProxyVerifiedHandshake": "disabled",
                    "sslSignHash": "any",
                    "strictResume": "disabled",
                    "uncleanShutdown": "enabled",
                    "certKeyChain": [
                        {
                            "name": "default",
                            "appService": "none",
                            "cert": "/Common/default.crt",
                            "certReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                            },
                            "chain": "none",
                            "key": "/Common/default.key",
                            "keyReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                            },
                            "usage": "SERVER",
                        }
                    ],
                },
                {
                    "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                    "name": "splitsession-default-clientssl",
                    "partition": "Common",
                    "fullPath": "/Common/splitsession-default-clientssl",
                    "generation": 1,
                    "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~splitsession-default-clientssl?ver=14.1.2.1",
                    "alertTimeout": "indefinite",
                    "allowDynamicRecordSizing": "disabled",
                    "allowExpiredCrl": "disabled",
                    "allowNonSsl": "disabled",
                    "appService": "none",
                    "authenticate": "once",
                    "authenticateDepth": 9,
                    "bypassOnClientCertFail": "disabled",
                    "bypassOnHandshakeAlert": "disabled",
                    "c3dDropUnknownOcspStatus": "drop",
                    "c3dOcsp": "none",
                    "caFile": "none",
                    "cacheSize": 262144,
                    "cacheTimeout": 3600,
                    "cert": "/Common/default.crt",
                    "certReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                    },
                    "certExtensionIncludes": [
                        "basic-constraints",
                        "subject-alternative-name",
                    ],
                    "certLifespan": 30,
                    "certLookupByIpaddrPort": "disabled",
                    "chain": "none",
                    "cipherGroup": "none",
                    "ciphers": "DEFAULT",
                    "clientCertCa": "none",
                    "crlFile": "none",
                    "defaultsFrom": "/Common/clientssl",
                    "defaultsFromReference": {
                        "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                    },
                    "description": "none",
                    "destinationIpBlacklist": "none",
                    "destinationIpWhitelist": "none",
                    "forwardProxyBypassDefaultAction": "intercept",
                    "genericAlert": "enabled",
                    "handshakeTimeout": "10",
                    "hostnameBlacklist": "none",
                    "hostnameWhitelist": "none",
                    "inheritCaCertkeychain": "false",
                    "inheritCertkeychain": "true",
                    "key": "/Common/default.key",
                    "keyReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                    },
                    "maxActiveHandshakes": "indefinite",
                    "maxAggregateRenegotiationPerMinute": "indefinite",
                    "maxRenegotiationsPerMinute": 5,
                    "maximumRecordSize": 16384,
                    "modSslMethods": "disabled",
                    "mode": "enabled",
                    "notifyCertStatusToVirtualServer": "disabled",
                    "ocspStapling": "disabled",
                    "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                    "peerCertMode": "ignore",
                    "peerNoRenegotiateTimeout": "10",
                    "proxyCaCert": "none",
                    "proxyCaKey": "none",
                    "proxySsl": "disabled",
                    "proxySslPassthrough": "disabled",
                    "renegotiateMaxRecordDelay": "indefinite",
                    "renegotiatePeriod": "indefinite",
                    "renegotiateSize": "indefinite",
                    "renegotiation": "enabled",
                    "retainCertificate": "true",
                    "secureRenegotiation": "require",
                    "serverName": "none",
                    "sessionMirroring": "disabled",
                    "sessionTicket": "disabled",
                    "sessionTicketTimeout": 0,
                    "sniDefault": "false",
                    "sniRequire": "false",
                    "sourceIpBlacklist": "none",
                    "sourceIpWhitelist": "none",
                    "sslC3d": "disabled",
                    "sslForwardProxy": "disabled",
                    "sslForwardProxyBypass": "disabled",
                    "sslForwardProxyVerifiedHandshake": "disabled",
                    "sslSignHash": "any",
                    "strictResume": "disabled",
                    "uncleanShutdown": "enabled",
                    "certKeyChain": [
                        {
                            "name": "default",
                            "appService": "none",
                            "cert": "/Common/default.crt",
                            "certReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                            },
                            "chain": "none",
                            "key": "/Common/default.key",
                            "keyReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                            },
                            "usage": "SERVER",
                        }
                    ],
                },
                {
                    "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                    "name": "wom-default-clientssl",
                    "partition": "Common",
                    "fullPath": "/Common/wom-default-clientssl",
                    "generation": 1,
                    "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~wom-default-clientssl?ver=14.1.2.1",
                    "alertTimeout": "indefinite",
                    "allowDynamicRecordSizing": "disabled",
                    "allowExpiredCrl": "disabled",
                    "allowNonSsl": "enabled",
                    "appService": "none",
                    "authenticate": "once",
                    "authenticateDepth": 9,
                    "bypassOnClientCertFail": "disabled",
                    "bypassOnHandshakeAlert": "disabled",
                    "c3dDropUnknownOcspStatus": "drop",
                    "c3dOcsp": "none",
                    "caFile": "none",
                    "cacheSize": 262144,
                    "cacheTimeout": 3600,
                    "cert": "/Common/default.crt",
                    "certReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                    },
                    "certExtensionIncludes": [
                        "basic-constraints",
                        "subject-alternative-name",
                    ],
                    "certLifespan": 30,
                    "certLookupByIpaddrPort": "disabled",
                    "chain": "none",
                    "cipherGroup": "none",
                    "ciphers": "DEFAULT",
                    "clientCertCa": "none",
                    "crlFile": "none",
                    "defaultsFrom": "/Common/clientssl",
                    "defaultsFromReference": {
                        "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                    },
                    "description": "none",
                    "destinationIpBlacklist": "none",
                    "destinationIpWhitelist": "none",
                    "forwardProxyBypassDefaultAction": "intercept",
                    "genericAlert": "enabled",
                    "handshakeTimeout": "10",
                    "hostnameBlacklist": "none",
                    "hostnameWhitelist": "none",
                    "inheritCaCertkeychain": "false",
                    "inheritCertkeychain": "true",
                    "key": "/Common/default.key",
                    "keyReference": {
                        "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                    },
                    "maxActiveHandshakes": "indefinite",
                    "maxAggregateRenegotiationPerMinute": "indefinite",
                    "maxRenegotiationsPerMinute": 5,
                    "maximumRecordSize": 16384,
                    "modSslMethods": "disabled",
                    "mode": "enabled",
                    "notifyCertStatusToVirtualServer": "disabled",
                    "ocspStapling": "disabled",
                    "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                    "peerCertMode": "ignore",
                    "peerNoRenegotiateTimeout": "10",
                    "proxyCaCert": "none",
                    "proxyCaKey": "none",
                    "proxySsl": "disabled",
                    "proxySslPassthrough": "disabled",
                    "renegotiateMaxRecordDelay": "indefinite",
                    "renegotiatePeriod": "indefinite",
                    "renegotiateSize": "indefinite",
                    "renegotiation": "enabled",
                    "retainCertificate": "true",
                    "secureRenegotiation": "require",
                    "serverName": "none",
                    "sessionMirroring": "disabled",
                    "sessionTicket": "disabled",
                    "sessionTicketTimeout": 0,
                    "sniDefault": "false",
                    "sniRequire": "false",
                    "sourceIpBlacklist": "none",
                    "sourceIpWhitelist": "none",
                    "sslC3d": "disabled",
                    "sslForwardProxy": "disabled",
                    "sslForwardProxyBypass": "disabled",
                    "sslForwardProxyVerifiedHandshake": "disabled",
                    "sslSignHash": "any",
                    "strictResume": "disabled",
                    "uncleanShutdown": "enabled",
                    "certKeyChain": [
                        {
                            "name": "default",
                            "appService": "none",
                            "cert": "/Common/default.crt",
                            "certReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                            },
                            "chain": "none",
                            "key": "/Common/default.key",
                            "keyReference": {
                                "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                            },
                            "usage": "SERVER",
                        }
                    ],
                },
            ],
        }


class test_get_ltm_profileclient_ssl(unittest.TestCase):

    maxDiff = None

    empty_output = {"get.return_value": {}}

    golden_parsed_output = {
        "items": [
            {
                "alertTimeout": "indefinite",
                "allowDynamicRecordSizing": "disabled",
                "allowExpiredCrl": "disabled",
                "allowNonSsl": "disabled",
                "appService": "none",
                "authenticate": "once",
                "authenticateDepth": 9,
                "bypassOnClientCertFail": "disabled",
                "bypassOnHandshakeAlert": "disabled",
                "c3dDropUnknownOcspStatus": "drop",
                "c3dOcsp": "none",
                "caFile": "none",
                "cacheSize": 262144,
                "cacheTimeout": 3600,
                "cert": "/Common/default.crt",
                "certExtensionIncludes": [
                    "basic-constraints",
                    "subject-alternative-name",
                ],
                "certKeyChain": [
                    {
                        "appService": "none",
                        "cert": "/Common/default.crt",
                        "certReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                        },
                        "chain": "none",
                        "key": "/Common/default.key",
                        "keyReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                        },
                        "name": "default",
                        "usage": "SERVER",
                    }
                ],
                "certLifespan": 30,
                "certLookupByIpaddrPort": "disabled",
                "certReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                },
                "chain": "none",
                "cipherGroup": "none",
                "ciphers": "DEFAULT",
                "clientCertCa": "none",
                "crlFile": "none",
                "defaultsFrom": "none",
                "description": "none",
                "destinationIpBlacklist": "none",
                "destinationIpWhitelist": "none",
                "forwardProxyBypassDefaultAction": "intercept",
                "fullPath": "/Common/clientssl",
                "generation": 1,
                "genericAlert": "enabled",
                "handshakeTimeout": "10",
                "hostnameBlacklist": "none",
                "hostnameWhitelist": "none",
                "inheritCaCertkeychain": "false",
                "inheritCertkeychain": "false",
                "key": "/Common/default.key",
                "keyReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                },
                "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                "maxActiveHandshakes": "indefinite",
                "maxAggregateRenegotiationPerMinute": "indefinite",
                "maxRenegotiationsPerMinute": 5,
                "maximumRecordSize": 16384,
                "modSslMethods": "disabled",
                "mode": "enabled",
                "name": "clientssl",
                "notifyCertStatusToVirtualServer": "disabled",
                "ocspStapling": "disabled",
                "partition": "Common",
                "peerCertMode": "ignore",
                "peerNoRenegotiateTimeout": "10",
                "proxyCaCert": "none",
                "proxyCaKey": "none",
                "proxySsl": "disabled",
                "proxySslPassthrough": "disabled",
                "renegotiateMaxRecordDelay": "indefinite",
                "renegotiatePeriod": "indefinite",
                "renegotiateSize": "indefinite",
                "renegotiation": "enabled",
                "retainCertificate": "true",
                "secureRenegotiation": "require",
                "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1",
                "serverName": "none",
                "sessionMirroring": "disabled",
                "sessionTicket": "disabled",
                "sessionTicketTimeout": 0,
                "sniDefault": "false",
                "sniRequire": "false",
                "sourceIpBlacklist": "none",
                "sourceIpWhitelist": "none",
                "sslC3d": "disabled",
                "sslForwardProxy": "disabled",
                "sslForwardProxyBypass": "disabled",
                "sslForwardProxyVerifiedHandshake": "disabled",
                "sslSignHash": "any",
                "strictResume": "disabled",
                "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                "uncleanShutdown": "enabled",
            },
            {
                "alertTimeout": "indefinite",
                "allowDynamicRecordSizing": "disabled",
                "allowExpiredCrl": "disabled",
                "allowNonSsl": "disabled",
                "appService": "none",
                "authenticate": "once",
                "authenticateDepth": 9,
                "bypassOnClientCertFail": "disabled",
                "bypassOnHandshakeAlert": "disabled",
                "c3dDropUnknownOcspStatus": "drop",
                "c3dOcsp": "none",
                "caFile": "none",
                "cacheSize": 262144,
                "cacheTimeout": 3600,
                "cert": "/Common/default.crt",
                "certExtensionIncludes": [
                    "basic-constraints",
                    "subject-alternative-name",
                ],
                "certKeyChain": [
                    {
                        "appService": "none",
                        "cert": "/Common/default.crt",
                        "certReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                        },
                        "chain": "none",
                        "key": "/Common/default.key",
                        "keyReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                        },
                        "name": "default",
                        "usage": "SERVER",
                    }
                ],
                "certLifespan": 30,
                "certLookupByIpaddrPort": "disabled",
                "certReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                },
                "chain": "none",
                "cipherGroup": "none",
                "ciphers": "ALL:!DH:!ADH:!EDH:@SPEED",
                "clientCertCa": "none",
                "crlFile": "none",
                "defaultsFrom": "/Common/clientssl",
                "defaultsFromReference": {
                    "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                },
                "description": "none",
                "destinationIpBlacklist": "none",
                "destinationIpWhitelist": "none",
                "forwardProxyBypassDefaultAction": "intercept",
                "fullPath": "/Common/clientssl-insecure-compatible",
                "generation": 1,
                "genericAlert": "enabled",
                "handshakeTimeout": "10",
                "hostnameBlacklist": "none",
                "hostnameWhitelist": "none",
                "inheritCaCertkeychain": "false",
                "inheritCertkeychain": "true",
                "key": "/Common/default.key",
                "keyReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                },
                "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                "maxActiveHandshakes": "indefinite",
                "maxAggregateRenegotiationPerMinute": "indefinite",
                "maxRenegotiationsPerMinute": 5,
                "maximumRecordSize": 16384,
                "modSslMethods": "disabled",
                "mode": "enabled",
                "name": "clientssl-insecure-compatible",
                "notifyCertStatusToVirtualServer": "disabled",
                "ocspStapling": "disabled",
                "partition": "Common",
                "peerCertMode": "ignore",
                "peerNoRenegotiateTimeout": "10",
                "proxyCaCert": "none",
                "proxyCaKey": "none",
                "proxySsl": "disabled",
                "proxySslPassthrough": "disabled",
                "renegotiateMaxRecordDelay": "indefinite",
                "renegotiatePeriod": "indefinite",
                "renegotiateSize": "indefinite",
                "renegotiation": "enabled",
                "retainCertificate": "true",
                "secureRenegotiation": "request",
                "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl-insecure-compatible?ver=14.1.2.1",
                "serverName": "none",
                "sessionMirroring": "disabled",
                "sessionTicket": "disabled",
                "sessionTicketTimeout": 0,
                "sniDefault": "false",
                "sniRequire": "false",
                "sourceIpBlacklist": "none",
                "sourceIpWhitelist": "none",
                "sslC3d": "disabled",
                "sslForwardProxy": "disabled",
                "sslForwardProxyBypass": "disabled",
                "sslForwardProxyVerifiedHandshake": "disabled",
                "sslSignHash": "any",
                "strictResume": "disabled",
                "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                "uncleanShutdown": "enabled",
            },
            {
                "alertTimeout": "indefinite",
                "allowDynamicRecordSizing": "disabled",
                "allowExpiredCrl": "disabled",
                "allowNonSsl": "disabled",
                "appService": "none",
                "authenticate": "once",
                "authenticateDepth": 9,
                "bypassOnClientCertFail": "disabled",
                "bypassOnHandshakeAlert": "disabled",
                "c3dDropUnknownOcspStatus": "drop",
                "c3dOcsp": "none",
                "caFile": "none",
                "cacheSize": 262144,
                "cacheTimeout": 3600,
                "cert": "/Common/default.crt",
                "certExtensionIncludes": [
                    "basic-constraints",
                    "subject-alternative-name",
                ],
                "certKeyChain": [
                    {
                        "appService": "none",
                        "cert": "/Common/default.crt",
                        "certReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                        },
                        "chain": "none",
                        "key": "/Common/default.key",
                        "keyReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                        },
                        "name": "default",
                        "usage": "SERVER",
                    }
                ],
                "certLifespan": 30,
                "certLookupByIpaddrPort": "disabled",
                "certReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                },
                "chain": "none",
                "cipherGroup": "none",
                "ciphers": "ecdhe:rsa:!sslv3:!rc4:!exp:!des",
                "clientCertCa": "none",
                "crlFile": "none",
                "defaultsFrom": "/Common/clientssl",
                "defaultsFromReference": {
                    "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                },
                "description": "none",
                "destinationIpBlacklist": "none",
                "destinationIpWhitelist": "none",
                "forwardProxyBypassDefaultAction": "intercept",
                "fullPath": "/Common/clientssl-secure",
                "generation": 1,
                "genericAlert": "enabled",
                "handshakeTimeout": "10",
                "hostnameBlacklist": "none",
                "hostnameWhitelist": "none",
                "inheritCaCertkeychain": "false",
                "inheritCertkeychain": "true",
                "key": "/Common/default.key",
                "keyReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                },
                "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                "maxActiveHandshakes": "indefinite",
                "maxAggregateRenegotiationPerMinute": "indefinite",
                "maxRenegotiationsPerMinute": 5,
                "maximumRecordSize": 16384,
                "modSslMethods": "disabled",
                "mode": "enabled",
                "name": "clientssl-secure",
                "notifyCertStatusToVirtualServer": "disabled",
                "ocspStapling": "disabled",
                "partition": "Common",
                "peerCertMode": "ignore",
                "peerNoRenegotiateTimeout": "10",
                "proxyCaCert": "none",
                "proxyCaKey": "none",
                "proxySsl": "disabled",
                "proxySslPassthrough": "disabled",
                "renegotiateMaxRecordDelay": "indefinite",
                "renegotiatePeriod": "indefinite",
                "renegotiateSize": "indefinite",
                "renegotiation": "disabled",
                "retainCertificate": "true",
                "secureRenegotiation": "require",
                "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl-secure?ver=14.1.2.1",
                "serverName": "none",
                "sessionMirroring": "disabled",
                "sessionTicket": "disabled",
                "sessionTicketTimeout": 0,
                "sniDefault": "false",
                "sniRequire": "false",
                "sourceIpBlacklist": "none",
                "sourceIpWhitelist": "none",
                "sslC3d": "disabled",
                "sslForwardProxy": "disabled",
                "sslForwardProxyBypass": "disabled",
                "sslForwardProxyVerifiedHandshake": "disabled",
                "sslSignHash": "any",
                "strictResume": "disabled",
                "tmOptions": "{ no-ssl }",
                "uncleanShutdown": "enabled",
            },
            {
                "alertTimeout": "indefinite",
                "allowDynamicRecordSizing": "disabled",
                "allowExpiredCrl": "disabled",
                "allowNonSsl": "disabled",
                "appService": "none",
                "authenticate": "once",
                "authenticateDepth": 9,
                "bypassOnClientCertFail": "disabled",
                "bypassOnHandshakeAlert": "disabled",
                "c3dDropUnknownOcspStatus": "drop",
                "c3dOcsp": "none",
                "caFile": "none",
                "cacheSize": 0,
                "cacheTimeout": 3600,
                "cert": "/Common/default.crt",
                "certExtensionIncludes": [
                    "basic-constraints",
                    "subject-alternative-name",
                ],
                "certKeyChain": [
                    {
                        "appService": "none",
                        "cert": "/Common/default.crt",
                        "certReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                        },
                        "chain": "none",
                        "key": "/Common/default.key",
                        "keyReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                        },
                        "name": "default",
                        "usage": "SERVER",
                    }
                ],
                "certLifespan": 30,
                "certLookupByIpaddrPort": "disabled",
                "certReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                },
                "chain": "none",
                "cipherGroup": "none",
                "ciphers": "DHE-RSA-AES256-GCM-SHA384",
                "clientCertCa": "none",
                "crlFile": "none",
                "defaultsFrom": "/Common/clientssl",
                "defaultsFromReference": {
                    "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                },
                "description": "none",
                "destinationIpBlacklist": "none",
                "destinationIpWhitelist": "none",
                "forwardProxyBypassDefaultAction": "intercept",
                "fullPath": "/Common/crypto-server-default-clientssl",
                "generation": 1,
                "genericAlert": "enabled",
                "handshakeTimeout": "10",
                "hostnameBlacklist": "none",
                "hostnameWhitelist": "none",
                "inheritCaCertkeychain": "false",
                "inheritCertkeychain": "true",
                "key": "/Common/default.key",
                "keyReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                },
                "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                "maxActiveHandshakes": "indefinite",
                "maxAggregateRenegotiationPerMinute": "indefinite",
                "maxRenegotiationsPerMinute": 5,
                "maximumRecordSize": 16384,
                "modSslMethods": "disabled",
                "mode": "enabled",
                "name": "crypto-server-default-clientssl",
                "notifyCertStatusToVirtualServer": "disabled",
                "ocspStapling": "disabled",
                "partition": "Common",
                "peerCertMode": "ignore",
                "peerNoRenegotiateTimeout": "10",
                "proxyCaCert": "none",
                "proxyCaKey": "none",
                "proxySsl": "disabled",
                "proxySslPassthrough": "disabled",
                "renegotiateMaxRecordDelay": "indefinite",
                "renegotiatePeriod": "21600",
                "renegotiateSize": "indefinite",
                "renegotiation": "enabled",
                "retainCertificate": "true",
                "secureRenegotiation": "require",
                "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~crypto-server-default-clientssl?ver=14.1.2.1",
                "serverName": "none",
                "sessionMirroring": "disabled",
                "sessionTicket": "disabled",
                "sessionTicketTimeout": 0,
                "sniDefault": "false",
                "sniRequire": "false",
                "sourceIpBlacklist": "none",
                "sourceIpWhitelist": "none",
                "sslC3d": "disabled",
                "sslForwardProxy": "disabled",
                "sslForwardProxyBypass": "disabled",
                "sslForwardProxyVerifiedHandshake": "disabled",
                "sslSignHash": "any",
                "strictResume": "disabled",
                "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                "uncleanShutdown": "enabled",
            },
            {
                "alertTimeout": "indefinite",
                "allowDynamicRecordSizing": "disabled",
                "allowExpiredCrl": "disabled",
                "allowNonSsl": "disabled",
                "appService": "none",
                "authenticate": "once",
                "authenticateDepth": 9,
                "bypassOnClientCertFail": "disabled",
                "bypassOnHandshakeAlert": "disabled",
                "c3dDropUnknownOcspStatus": "drop",
                "c3dOcsp": "none",
                "caFile": "none",
                "cacheSize": 262144,
                "cacheTimeout": 3600,
                "cert": "/Common/default.crt",
                "certExtensionIncludes": [
                    "basic-constraints",
                    "subject-alternative-name",
                ],
                "certKeyChain": [
                    {
                        "appService": "none",
                        "cert": "/Common/default.crt",
                        "certReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                        },
                        "chain": "none",
                        "key": "/Common/default.key",
                        "keyReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                        },
                        "name": "default",
                        "usage": "SERVER",
                    }
                ],
                "certLifespan": 30,
                "certLookupByIpaddrPort": "disabled",
                "certReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                },
                "chain": "none",
                "cipherGroup": "none",
                "ciphers": "DEFAULT",
                "clientCertCa": "none",
                "crlFile": "none",
                "defaultsFrom": "/Common/clientssl",
                "defaultsFromReference": {
                    "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                },
                "description": "none",
                "destinationIpBlacklist": "none",
                "destinationIpWhitelist": "none",
                "forwardProxyBypassDefaultAction": "intercept",
                "fullPath": "/Common/splitsession-default-clientssl",
                "generation": 1,
                "genericAlert": "enabled",
                "handshakeTimeout": "10",
                "hostnameBlacklist": "none",
                "hostnameWhitelist": "none",
                "inheritCaCertkeychain": "false",
                "inheritCertkeychain": "true",
                "key": "/Common/default.key",
                "keyReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                },
                "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                "maxActiveHandshakes": "indefinite",
                "maxAggregateRenegotiationPerMinute": "indefinite",
                "maxRenegotiationsPerMinute": 5,
                "maximumRecordSize": 16384,
                "modSslMethods": "disabled",
                "mode": "enabled",
                "name": "splitsession-default-clientssl",
                "notifyCertStatusToVirtualServer": "disabled",
                "ocspStapling": "disabled",
                "partition": "Common",
                "peerCertMode": "ignore",
                "peerNoRenegotiateTimeout": "10",
                "proxyCaCert": "none",
                "proxyCaKey": "none",
                "proxySsl": "disabled",
                "proxySslPassthrough": "disabled",
                "renegotiateMaxRecordDelay": "indefinite",
                "renegotiatePeriod": "indefinite",
                "renegotiateSize": "indefinite",
                "renegotiation": "enabled",
                "retainCertificate": "true",
                "secureRenegotiation": "require",
                "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~splitsession-default-clientssl?ver=14.1.2.1",
                "serverName": "none",
                "sessionMirroring": "disabled",
                "sessionTicket": "disabled",
                "sessionTicketTimeout": 0,
                "sniDefault": "false",
                "sniRequire": "false",
                "sourceIpBlacklist": "none",
                "sourceIpWhitelist": "none",
                "sslC3d": "disabled",
                "sslForwardProxy": "disabled",
                "sslForwardProxyBypass": "disabled",
                "sslForwardProxyVerifiedHandshake": "disabled",
                "sslSignHash": "any",
                "strictResume": "disabled",
                "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                "uncleanShutdown": "enabled",
            },
            {
                "alertTimeout": "indefinite",
                "allowDynamicRecordSizing": "disabled",
                "allowExpiredCrl": "disabled",
                "allowNonSsl": "enabled",
                "appService": "none",
                "authenticate": "once",
                "authenticateDepth": 9,
                "bypassOnClientCertFail": "disabled",
                "bypassOnHandshakeAlert": "disabled",
                "c3dDropUnknownOcspStatus": "drop",
                "c3dOcsp": "none",
                "caFile": "none",
                "cacheSize": 262144,
                "cacheTimeout": 3600,
                "cert": "/Common/default.crt",
                "certExtensionIncludes": [
                    "basic-constraints",
                    "subject-alternative-name",
                ],
                "certKeyChain": [
                    {
                        "appService": "none",
                        "cert": "/Common/default.crt",
                        "certReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                        },
                        "chain": "none",
                        "key": "/Common/default.key",
                        "keyReference": {
                            "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                        },
                        "name": "default",
                        "usage": "SERVER",
                    }
                ],
                "certLifespan": 30,
                "certLookupByIpaddrPort": "disabled",
                "certReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-cert/~Common~default.crt?ver=14.1.2.1"
                },
                "chain": "none",
                "cipherGroup": "none",
                "ciphers": "DEFAULT",
                "clientCertCa": "none",
                "crlFile": "none",
                "defaultsFrom": "/Common/clientssl",
                "defaultsFromReference": {
                    "link": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~clientssl?ver=14.1.2.1"
                },
                "description": "none",
                "destinationIpBlacklist": "none",
                "destinationIpWhitelist": "none",
                "forwardProxyBypassDefaultAction": "intercept",
                "fullPath": "/Common/wom-default-clientssl",
                "generation": 1,
                "genericAlert": "enabled",
                "handshakeTimeout": "10",
                "hostnameBlacklist": "none",
                "hostnameWhitelist": "none",
                "inheritCaCertkeychain": "false",
                "inheritCertkeychain": "true",
                "key": "/Common/default.key",
                "keyReference": {
                    "link": "https://localhost/mgmt/tm/sys/file/ssl-key/~Common~default.key?ver=14.1.2.1"
                },
                "kind": "tm:ltm:profile:client-ssl:client-sslstate",
                "maxActiveHandshakes": "indefinite",
                "maxAggregateRenegotiationPerMinute": "indefinite",
                "maxRenegotiationsPerMinute": 5,
                "maximumRecordSize": 16384,
                "modSslMethods": "disabled",
                "mode": "enabled",
                "name": "wom-default-clientssl",
                "notifyCertStatusToVirtualServer": "disabled",
                "ocspStapling": "disabled",
                "partition": "Common",
                "peerCertMode": "ignore",
                "peerNoRenegotiateTimeout": "10",
                "proxyCaCert": "none",
                "proxyCaKey": "none",
                "proxySsl": "disabled",
                "proxySslPassthrough": "disabled",
                "renegotiateMaxRecordDelay": "indefinite",
                "renegotiatePeriod": "indefinite",
                "renegotiateSize": "indefinite",
                "renegotiation": "enabled",
                "retainCertificate": "true",
                "secureRenegotiation": "require",
                "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl/~Common~wom-default-clientssl?ver=14.1.2.1",
                "serverName": "none",
                "sessionMirroring": "disabled",
                "sessionTicket": "disabled",
                "sessionTicketTimeout": 0,
                "sniDefault": "false",
                "sniRequire": "false",
                "sourceIpBlacklist": "none",
                "sourceIpWhitelist": "none",
                "sslC3d": "disabled",
                "sslForwardProxy": "disabled",
                "sslForwardProxyBypass": "disabled",
                "sslForwardProxyVerifiedHandshake": "disabled",
                "sslSignHash": "any",
                "strictResume": "disabled",
                "tmOptions": "{ dont-insert-empty-fragments no-tlsv1.3 }",
                "uncleanShutdown": "enabled",
            },
        ],
        "kind": "tm:ltm:profile:client-ssl:client-sslcollectionstate",
        "selfLink": "https://localhost/mgmt/tm/ltm/profile/client-ssl?ver=14.1.2.1",
    }

    golden_output = {"get.return_value": FakeResponse()}

    # def test_empty(self):
    #     self.device1 = Mock(**self.empty_output)
    #     obj = LtmProfileClientssl(device=self.device1, alias='rest', via='rest', context='rest')
    #     with self.assertRaises(SchemaEmptyParserError):
    #         parsed_output = obj.parse()

    def test_golden(self):
        self.device = Mock(**self.golden_output)
        obj = LtmProfileClientssl(
            device=self.device, alias="rest", via="rest", context="rest"
        )
        parsed_output = obj.parse()
        self.assertEqual(parsed_output, self.golden_parsed_output)


if __name__ == "__main__":
    unittest.main()
